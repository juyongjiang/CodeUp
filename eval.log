/hpc2hdd/home/jjiang472/.conda/envs/llms_latest/lib/python3.10/site-packages/transformers/utils/generic.py:311: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  torch.utils._pytree._register_pytree_node(
The following values were not passed to `accelerate launch` and had defaults used instead:
	`--num_processes` was set to a value of `1`
	`--num_machines` was set to a value of `1`
	`--mixed_precision` was set to a value of `'no'`
	`--dynamo_backend` was set to a value of `'no'`
To avoid this warning pass in values for each of the problematic parameters or run `accelerate config`.
/hpc2hdd/home/jjiang472/.conda/envs/llms_latest/lib/python3.10/site-packages/transformers/utils/generic.py:311: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  torch.utils._pytree._register_pytree_node(
/hpc2hdd/home/jjiang472/.conda/envs/llms_latest/lib/python3.10/site-packages/transformers/utils/generic.py:311: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  torch.utils._pytree._register_pytree_node(
Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
Selected Tasks: ['mbpp']
Loading model in fp32
Traceback (most recent call last):
  File "/hpc2hdd/home/jjiang472/CodeUp-Large-Powerful/bigcode-evaluation-harness/main.py", line 414, in <module>
    main()
  File "/hpc2hdd/home/jjiang472/CodeUp-Large-Powerful/bigcode-evaluation-harness/main.py", line 296, in main
    model = AutoModelForCausalLM.from_pretrained(
  File "/hpc2hdd/home/jjiang472/.conda/envs/llms_latest/lib/python3.10/site-packages/transformers/models/auto/auto_factory.py", line 494, in from_pretrained
    resolved_config_file = cached_file(
  File "/hpc2hdd/home/jjiang472/.conda/envs/llms_latest/lib/python3.10/site-packages/transformers/utils/hub.py", line 429, in cached_file
    resolved_file = hf_hub_download(
  File "/hpc2hdd/home/jjiang472/.conda/envs/llms_latest/lib/python3.10/site-packages/huggingface_hub/utils/_validators.py", line 106, in _inner_fn
    validate_repo_id(arg_value)
  File "/hpc2hdd/home/jjiang472/.conda/envs/llms_latest/lib/python3.10/site-packages/huggingface_hub/utils/_validators.py", line 154, in validate_repo_id
    raise HFValidationError(
huggingface_hub.errors.HFValidationError: Repo id must be in the form 'repo_name' or 'namespace/repo_name': './codeup-peft-llama-3-8b/merged'. Use `repo_type` argument if needed.
Traceback (most recent call last):
  File "/hpc2hdd/home/jjiang472/.conda/envs/llms_latest/bin/accelerate", line 8, in <module>
    sys.exit(main())
  File "/hpc2hdd/home/jjiang472/.conda/envs/llms_latest/lib/python3.10/site-packages/accelerate/commands/accelerate_cli.py", line 48, in main
    args.func(args)
  File "/hpc2hdd/home/jjiang472/.conda/envs/llms_latest/lib/python3.10/site-packages/accelerate/commands/launch.py", line 1097, in launch_command
    simple_launcher(args)
  File "/hpc2hdd/home/jjiang472/.conda/envs/llms_latest/lib/python3.10/site-packages/accelerate/commands/launch.py", line 703, in simple_launcher
    raise subprocess.CalledProcessError(returncode=process.returncode, cmd=cmd)
subprocess.CalledProcessError: Command '['/hpc2hdd/home/jjiang472/.conda/envs/llms_latest/bin/python', 'main.py', '--model', './codeup-peft-llama-3-8b/merged', '--max_length_generation', '1024', '--tasks', 'mbpp', '--temperature', '0.1', '--n_samples', '15', '--batch_size', '10', '--allow_code_execution', '--save_generations', '--save_generations_path', 'generations_mbpp.json']' returned non-zero exit status 1.
